{"ast":null,"code":"'use strict';\n\nfunction _interopDefault(ex) {\n  return ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nrequire('react');\n\nvar L = _interopDefault(require('leaflet'));\n\nvar reactLeaflet = require('react-leaflet');\n\nvar PropTypes = _interopDefault(require('prop-types'));\n\nvar _class, _temp;\n\nfunction safeRemoveLayer(leafletMap, el) {\n  const {\n    overlayPane\n  } = leafletMap.getPanes();\n\n  if (overlayPane && overlayPane.contains(el)) {\n    overlayPane.removeChild(el);\n  }\n}\n\nvar CanvasLayer = reactLeaflet.withLeaflet((_temp = _class = class CanvasLayer extends reactLeaflet.MapLayer {\n  createLeafletElement() {\n    return null;\n  }\n\n  componentDidMount() {\n    const canAnimate = this.props.leaflet.map.options.zoomAnimation && L.Browser.any3d;\n    const zoomClass = `leaflet-zoom-${canAnimate ? 'animated' : 'hide'}`;\n    const mapSize = this.props.leaflet.map.getSize();\n    const transformProp = L.DomUtil.testProp(['transformOrigin', 'WebkitTransformOrigin', 'msTransformOrigin']);\n    this._el = L.DomUtil.create('canvas', zoomClass);\n    this._el.style[transformProp] = '50% 50%';\n    this._el.width = mapSize.x;\n    this._el.height = mapSize.y;\n    const el = this._el;\n\n    const _CanvasLayer = L.Layer.extend({\n      onAdd: leafletMap => leafletMap.getPanes().overlayPane.appendChild(el),\n      addTo: leafletMap => {\n        leafletMap.addLayer(this);\n        return this;\n      },\n      onRemove: leafletMap => safeRemoveLayer(leafletMap, el)\n    });\n\n    this.leafletElement = new _CanvasLayer();\n    super.componentDidMount();\n    this.reset();\n    this.attachEvents();\n  }\n\n  componentWillUnmount() {\n    safeRemoveLayer(this.props.leaflet.map, this._el);\n  }\n\n  componentDidUpdate() {\n    this.props.leaflet.map.invalidateSize();\n    this.reset();\n  }\n\n  shouldComponentUpdate() {\n    return true;\n  }\n\n  attachEvents() {\n    const leafletMap = this.props.leaflet.map;\n    leafletMap.on('viewreset', () => this.reset());\n    leafletMap.on('moveend', () => this.reset());\n\n    if (leafletMap.options.zoomAnimation && L.Browser.any3d) {\n      leafletMap.on('zoomanim', this._animateZoom, this);\n    }\n  }\n\n  _animateZoom(e) {\n    const scale = this.props.leaflet.map.getZoomScale(e.zoom);\n\n    const offset = this.props.leaflet.map._getCenterOffset(e.center)._multiplyBy(-scale).subtract(this.props.leaflet.map._getMapPanePos());\n\n    if (L.DomUtil.setTransform) {\n      L.DomUtil.setTransform(this._el, offset, scale);\n    } else {\n      this._el.style[L.DomUtil.TRANSFORM] = `${L.DomUtil.getTranslateString(offset)} scale(${scale})`;\n    }\n  }\n\n  reset() {\n    const topLeft = this.props.leaflet.map.containerPointToLayerPoint([0, 0]);\n    L.DomUtil.setPosition(this._el, topLeft);\n    const size = this.props.leaflet.map.getSize();\n\n    if (this._el.width !== size.x) {\n      this._el.width = size.x;\n    }\n\n    if (this._el.height !== size.y) {\n      this._el.height = size.y;\n    }\n\n    if (this._el && !this._frame && !this.props.leaflet.map._animating) {\n      this._frame = L.Util.requestAnimFrame(this.redraw, this);\n    }\n\n    this.redraw();\n  }\n\n  redraw() {\n    const size = this.props.leaflet.map.getSize();\n    const bounds = this.props.leaflet.map.getBounds();\n    const zoom = this.props.leaflet.map.getZoom();\n    const center = this.props.leaflet.map.getCenter();\n    const corner = this.props.leaflet.map.containerPointToLatLng(this.props.leaflet.map.getSize());\n    const data = this.props.data;\n    this.props.drawMethod && this.props.drawMethod({\n      map: this.props.leaflet.map,\n      canvas: this._el,\n      bounds,\n      size,\n      zoom,\n      center,\n      corner,\n      data\n    });\n    this._frame = null;\n  }\n\n  render() {\n    return null;\n  }\n\n}, _class.propTypes = {\n  drawMethod: PropTypes.func\n}, _temp));\nmodule.exports = CanvasLayer;","map":{"version":3,"names":["_interopDefault","ex","require","L","reactLeaflet","PropTypes","_class","_temp","safeRemoveLayer","leafletMap","el","overlayPane","getPanes","contains","removeChild","CanvasLayer","withLeaflet","MapLayer","createLeafletElement","componentDidMount","canAnimate","props","leaflet","map","options","zoomAnimation","Browser","any3d","zoomClass","mapSize","getSize","transformProp","DomUtil","testProp","_el","create","style","width","x","height","y","_CanvasLayer","Layer","extend","onAdd","appendChild","addTo","addLayer","onRemove","leafletElement","reset","attachEvents","componentWillUnmount","componentDidUpdate","invalidateSize","shouldComponentUpdate","on","_animateZoom","e","scale","getZoomScale","zoom","offset","_getCenterOffset","center","_multiplyBy","subtract","_getMapPanePos","setTransform","TRANSFORM","getTranslateString","topLeft","containerPointToLayerPoint","setPosition","size","_frame","_animating","Util","requestAnimFrame","redraw","bounds","getBounds","getZoom","getCenter","corner","containerPointToLatLng","data","drawMethod","canvas","render","propTypes","func","module","exports"],"sources":["/Users/romanradionov/PycharmProjects/reactleafletgeodjango/my-app/node_modules/react-leaflet-canvas-layer/lib/CanvasLayer.js"],"sourcesContent":["'use strict';\n\nfunction _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }\n\nrequire('react');\nvar L = _interopDefault(require('leaflet'));\nvar reactLeaflet = require('react-leaflet');\nvar PropTypes = _interopDefault(require('prop-types'));\n\nvar _class, _temp;\n\nfunction safeRemoveLayer(leafletMap, el) {\n  const { overlayPane } = leafletMap.getPanes();\n  if (overlayPane && overlayPane.contains(el)) {\n    overlayPane.removeChild(el);\n  }\n}\n\nvar CanvasLayer = reactLeaflet.withLeaflet((_temp = _class = class CanvasLayer extends reactLeaflet.MapLayer {\n  createLeafletElement() {\n    return null;\n  }\n\n  componentDidMount() {\n    const canAnimate = this.props.leaflet.map.options.zoomAnimation && L.Browser.any3d;\n    const zoomClass = `leaflet-zoom-${canAnimate ? 'animated' : 'hide'}`;\n    const mapSize = this.props.leaflet.map.getSize();\n    const transformProp = L.DomUtil.testProp(['transformOrigin', 'WebkitTransformOrigin', 'msTransformOrigin']);\n\n    this._el = L.DomUtil.create('canvas', zoomClass);\n    this._el.style[transformProp] = '50% 50%';\n    this._el.width = mapSize.x;\n    this._el.height = mapSize.y;\n\n    const el = this._el;\n\n    const _CanvasLayer = L.Layer.extend({\n      onAdd: leafletMap => leafletMap.getPanes().overlayPane.appendChild(el),\n      addTo: leafletMap => {\n        leafletMap.addLayer(this);\n        return this;\n      },\n      onRemove: leafletMap => safeRemoveLayer(leafletMap, el)\n    });\n\n    this.leafletElement = new _CanvasLayer();\n    super.componentDidMount();\n    this.reset();\n\n    this.attachEvents();\n  }\n\n  componentWillUnmount() {\n    safeRemoveLayer(this.props.leaflet.map, this._el);\n  }\n\n  componentDidUpdate() {\n    this.props.leaflet.map.invalidateSize();\n    this.reset();\n  }\n\n  shouldComponentUpdate() {\n    return true;\n  }\n\n  attachEvents() {\n    const leafletMap = this.props.leaflet.map;\n    leafletMap.on('viewreset', () => this.reset());\n    leafletMap.on('moveend', () => this.reset());\n    if (leafletMap.options.zoomAnimation && L.Browser.any3d) {\n      leafletMap.on('zoomanim', this._animateZoom, this);\n    }\n  }\n\n  _animateZoom(e) {\n    const scale = this.props.leaflet.map.getZoomScale(e.zoom);\n    const offset = this.props.leaflet.map._getCenterOffset(e.center)._multiplyBy(-scale).subtract(this.props.leaflet.map._getMapPanePos());\n\n    if (L.DomUtil.setTransform) {\n      L.DomUtil.setTransform(this._el, offset, scale);\n    } else {\n      this._el.style[L.DomUtil.TRANSFORM] = `${L.DomUtil.getTranslateString(offset)} scale(${scale})`;\n    }\n  }\n\n  reset() {\n    const topLeft = this.props.leaflet.map.containerPointToLayerPoint([0, 0]);\n    L.DomUtil.setPosition(this._el, topLeft);\n\n    const size = this.props.leaflet.map.getSize();\n\n    if (this._el.width !== size.x) {\n      this._el.width = size.x;\n    }\n    if (this._el.height !== size.y) {\n      this._el.height = size.y;\n    }\n\n    if (this._el && !this._frame && !this.props.leaflet.map._animating) {\n      this._frame = L.Util.requestAnimFrame(this.redraw, this);\n    }\n\n    this.redraw();\n  }\n\n  redraw() {\n    const size = this.props.leaflet.map.getSize();\n    const bounds = this.props.leaflet.map.getBounds();\n    const zoom = this.props.leaflet.map.getZoom();\n    const center = this.props.leaflet.map.getCenter();\n    const corner = this.props.leaflet.map.containerPointToLatLng(this.props.leaflet.map.getSize());\n    const data = this.props.data;\n    this.props.drawMethod && this.props.drawMethod({\n      map: this.props.leaflet.map,\n      canvas: this._el,\n      bounds,\n      size,\n      zoom,\n      center,\n      corner,\n      data\n    });\n\n    this._frame = null;\n  }\n\n  render() {\n    return null;\n  }\n\n}, _class.propTypes = {\n  drawMethod: PropTypes.func\n}, _temp));\n\nmodule.exports = CanvasLayer;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}