{"ast":null,"code":"import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport pj_enfn from '../common/pj_enfn';\nvar MAX_ITER = 20;\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport { EPSLN, HALF_PI } from '../constants/values';\nimport asinz from '../common/asinz';\nexport function init() {\n  /* Place parameters in static storage for common use\n    -------------------------------------------------*/\n  if (!this.sphere) {\n    this.en = pj_enfn(this.es);\n  } else {\n    this.n = 1;\n    this.m = 0;\n    this.es = 0;\n    this.C_y = Math.sqrt((this.m + 1) / this.n);\n    this.C_x = this.C_y / (this.m + 1);\n  }\n}\n/* Sinusoidal forward equations--mapping lat,long to x,y\n  -----------------------------------------------------*/\n\nexport function forward(p) {\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n    -----------------*/\n\n  lon = adjust_lon(lon - this.long0);\n\n  if (this.sphere) {\n    if (!this.m) {\n      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;\n    } else {\n      var k = this.n * Math.sin(lat);\n\n      for (var i = MAX_ITER; i; --i) {\n        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));\n        lat -= V;\n\n        if (Math.abs(V) < EPSLN) {\n          break;\n        }\n      }\n    }\n\n    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));\n    y = this.a * this.C_y * lat;\n  } else {\n    var s = Math.sin(lat);\n    var c = Math.cos(lat);\n    y = this.a * pj_mlfn(lat, s, c, this.en);\n    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\nexport function inverse(p) {\n  var lat, temp, lon, s;\n  p.x -= this.x0;\n  lon = p.x / this.a;\n  p.y -= this.y0;\n  lat = p.y / this.a;\n\n  if (this.sphere) {\n    lat /= this.C_y;\n    lon = lon / (this.C_x * (this.m + Math.cos(lat)));\n\n    if (this.m) {\n      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);\n    } else if (this.n !== 1) {\n      lat = asinz(Math.sin(lat) / this.n);\n    }\n\n    lon = adjust_lon(lon + this.long0);\n    lat = adjust_lat(lat);\n  } else {\n    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);\n    s = Math.abs(lat);\n\n    if (s < HALF_PI) {\n      s = Math.sin(lat);\n      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat)); //temp = this.long0 + p.x / (this.a * Math.cos(lat));\n\n      lon = adjust_lon(temp);\n    } else if (s - EPSLN < HALF_PI) {\n      lon = this.long0;\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\nexport var names = [\"Sinusoidal\", \"sinu\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};","map":{"version":3,"names":["adjust_lon","adjust_lat","pj_enfn","MAX_ITER","pj_mlfn","pj_inv_mlfn","EPSLN","HALF_PI","asinz","init","sphere","en","es","n","m","C_y","Math","sqrt","C_x","forward","p","x","y","lon","lat","long0","asin","sin","k","i","V","cos","abs","a","s","c","inverse","temp","x0","y0","names"],"sources":["/Users/romanradionov/PycharmProjects/reactleafletgeodjango/my-app/node_modules/proj4/lib/projections/sinu.js"],"sourcesContent":["import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport pj_enfn from '../common/pj_enfn';\nvar MAX_ITER = 20;\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport {EPSLN, HALF_PI} from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n\nexport function init() {\n  /* Place parameters in static storage for common use\n    -------------------------------------------------*/\n\n\n  if (!this.sphere) {\n    this.en = pj_enfn(this.es);\n  }\n  else {\n    this.n = 1;\n    this.m = 0;\n    this.es = 0;\n    this.C_y = Math.sqrt((this.m + 1) / this.n);\n    this.C_x = this.C_y / (this.m + 1);\n  }\n\n}\n\n/* Sinusoidal forward equations--mapping lat,long to x,y\n  -----------------------------------------------------*/\nexport function forward(p) {\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n    -----------------*/\n  lon = adjust_lon(lon - this.long0);\n\n  if (this.sphere) {\n    if (!this.m) {\n      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;\n    }\n    else {\n      var k = this.n * Math.sin(lat);\n      for (var i = MAX_ITER; i; --i) {\n        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));\n        lat -= V;\n        if (Math.abs(V) < EPSLN) {\n          break;\n        }\n      }\n    }\n    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));\n    y = this.a * this.C_y * lat;\n\n  }\n  else {\n\n    var s = Math.sin(lat);\n    var c = Math.cos(lat);\n    y = this.a * pj_mlfn(lat, s, c, this.en);\n    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var lat, temp, lon, s;\n\n  p.x -= this.x0;\n  lon = p.x / this.a;\n  p.y -= this.y0;\n  lat = p.y / this.a;\n\n  if (this.sphere) {\n    lat /= this.C_y;\n    lon = lon / (this.C_x * (this.m + Math.cos(lat)));\n    if (this.m) {\n      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);\n    }\n    else if (this.n !== 1) {\n      lat = asinz(Math.sin(lat) / this.n);\n    }\n    lon = adjust_lon(lon + this.long0);\n    lat = adjust_lat(lat);\n  }\n  else {\n    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);\n    s = Math.abs(lat);\n    if (s < HALF_PI) {\n      s = Math.sin(lat);\n      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));\n      //temp = this.long0 + p.x / (this.a * Math.cos(lat));\n      lon = adjust_lon(temp);\n    }\n    else if ((s - EPSLN) < HALF_PI) {\n      lon = this.long0;\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Sinusoidal\", \"sinu\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,sBAAvB;AACA,OAAOC,UAAP,MAAuB,sBAAvB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,IAAIC,QAAQ,GAAG,EAAf;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AACA,SAAQC,KAAR,EAAeC,OAAf,QAA6B,qBAA7B;AAEA,OAAOC,KAAP,MAAkB,iBAAlB;AAGA,OAAO,SAASC,IAAT,GAAgB;EACrB;AACF;EAGE,IAAI,CAAC,KAAKC,MAAV,EAAkB;IAChB,KAAKC,EAAL,GAAUT,OAAO,CAAC,KAAKU,EAAN,CAAjB;EACD,CAFD,MAGK;IACH,KAAKC,CAAL,GAAS,CAAT;IACA,KAAKC,CAAL,GAAS,CAAT;IACA,KAAKF,EAAL,GAAU,CAAV;IACA,KAAKG,GAAL,GAAWC,IAAI,CAACC,IAAL,CAAU,CAAC,KAAKH,CAAL,GAAS,CAAV,IAAe,KAAKD,CAA9B,CAAX;IACA,KAAKK,GAAL,GAAW,KAAKH,GAAL,IAAY,KAAKD,CAAL,GAAS,CAArB,CAAX;EACD;AAEF;AAED;AACA;;AACA,OAAO,SAASK,OAAT,CAAiBC,CAAjB,EAAoB;EACzB,IAAIC,CAAJ,EAAOC,CAAP;EACA,IAAIC,GAAG,GAAGH,CAAC,CAACC,CAAZ;EACA,IAAIG,GAAG,GAAGJ,CAAC,CAACE,CAAZ;EACA;AACF;;EACEC,GAAG,GAAGvB,UAAU,CAACuB,GAAG,GAAG,KAAKE,KAAZ,CAAhB;;EAEA,IAAI,KAAKf,MAAT,EAAiB;IACf,IAAI,CAAC,KAAKI,CAAV,EAAa;MACXU,GAAG,GAAG,KAAKX,CAAL,KAAW,CAAX,GAAeG,IAAI,CAACU,IAAL,CAAU,KAAKb,CAAL,GAASG,IAAI,CAACW,GAAL,CAASH,GAAT,CAAnB,CAAf,GAAmDA,GAAzD;IACD,CAFD,MAGK;MACH,IAAII,CAAC,GAAG,KAAKf,CAAL,GAASG,IAAI,CAACW,GAAL,CAASH,GAAT,CAAjB;;MACA,KAAK,IAAIK,CAAC,GAAG1B,QAAb,EAAuB0B,CAAvB,EAA0B,EAAEA,CAA5B,EAA+B;QAC7B,IAAIC,CAAC,GAAG,CAAC,KAAKhB,CAAL,GAASU,GAAT,GAAeR,IAAI,CAACW,GAAL,CAASH,GAAT,CAAf,GAA+BI,CAAhC,KAAsC,KAAKd,CAAL,GAASE,IAAI,CAACe,GAAL,CAASP,GAAT,CAA/C,CAAR;QACAA,GAAG,IAAIM,CAAP;;QACA,IAAId,IAAI,CAACgB,GAAL,CAASF,CAAT,IAAcxB,KAAlB,EAAyB;UACvB;QACD;MACF;IACF;;IACDe,CAAC,GAAG,KAAKY,CAAL,GAAS,KAAKf,GAAd,GAAoBK,GAApB,IAA2B,KAAKT,CAAL,GAASE,IAAI,CAACe,GAAL,CAASP,GAAT,CAApC,CAAJ;IACAF,CAAC,GAAG,KAAKW,CAAL,GAAS,KAAKlB,GAAd,GAAoBS,GAAxB;EAED,CAjBD,MAkBK;IAEH,IAAIU,CAAC,GAAGlB,IAAI,CAACW,GAAL,CAASH,GAAT,CAAR;IACA,IAAIW,CAAC,GAAGnB,IAAI,CAACe,GAAL,CAASP,GAAT,CAAR;IACAF,CAAC,GAAG,KAAKW,CAAL,GAAS7B,OAAO,CAACoB,GAAD,EAAMU,CAAN,EAASC,CAAT,EAAY,KAAKxB,EAAjB,CAApB;IACAU,CAAC,GAAG,KAAKY,CAAL,GAASV,GAAT,GAAeY,CAAf,GAAmBnB,IAAI,CAACC,IAAL,CAAU,IAAI,KAAKL,EAAL,GAAUsB,CAAV,GAAcA,CAA5B,CAAvB;EACD;;EAEDd,CAAC,CAACC,CAAF,GAAMA,CAAN;EACAD,CAAC,CAACE,CAAF,GAAMA,CAAN;EACA,OAAOF,CAAP;AACD;AAED,OAAO,SAASgB,OAAT,CAAiBhB,CAAjB,EAAoB;EACzB,IAAII,GAAJ,EAASa,IAAT,EAAed,GAAf,EAAoBW,CAApB;EAEAd,CAAC,CAACC,CAAF,IAAO,KAAKiB,EAAZ;EACAf,GAAG,GAAGH,CAAC,CAACC,CAAF,GAAM,KAAKY,CAAjB;EACAb,CAAC,CAACE,CAAF,IAAO,KAAKiB,EAAZ;EACAf,GAAG,GAAGJ,CAAC,CAACE,CAAF,GAAM,KAAKW,CAAjB;;EAEA,IAAI,KAAKvB,MAAT,EAAiB;IACfc,GAAG,IAAI,KAAKT,GAAZ;IACAQ,GAAG,GAAGA,GAAG,IAAI,KAAKL,GAAL,IAAY,KAAKJ,CAAL,GAASE,IAAI,CAACe,GAAL,CAASP,GAAT,CAArB,CAAJ,CAAT;;IACA,IAAI,KAAKV,CAAT,EAAY;MACVU,GAAG,GAAGhB,KAAK,CAAC,CAAC,KAAKM,CAAL,GAASU,GAAT,GAAeR,IAAI,CAACW,GAAL,CAASH,GAAT,CAAhB,IAAiC,KAAKX,CAAvC,CAAX;IACD,CAFD,MAGK,IAAI,KAAKA,CAAL,KAAW,CAAf,EAAkB;MACrBW,GAAG,GAAGhB,KAAK,CAACQ,IAAI,CAACW,GAAL,CAASH,GAAT,IAAgB,KAAKX,CAAtB,CAAX;IACD;;IACDU,GAAG,GAAGvB,UAAU,CAACuB,GAAG,GAAG,KAAKE,KAAZ,CAAhB;IACAD,GAAG,GAAGvB,UAAU,CAACuB,GAAD,CAAhB;EACD,CAXD,MAYK;IACHA,GAAG,GAAGnB,WAAW,CAACe,CAAC,CAACE,CAAF,GAAM,KAAKW,CAAZ,EAAe,KAAKrB,EAApB,EAAwB,KAAKD,EAA7B,CAAjB;IACAuB,CAAC,GAAGlB,IAAI,CAACgB,GAAL,CAASR,GAAT,CAAJ;;IACA,IAAIU,CAAC,GAAG3B,OAAR,EAAiB;MACf2B,CAAC,GAAGlB,IAAI,CAACW,GAAL,CAASH,GAAT,CAAJ;MACAa,IAAI,GAAG,KAAKZ,KAAL,GAAaL,CAAC,CAACC,CAAF,GAAML,IAAI,CAACC,IAAL,CAAU,IAAI,KAAKL,EAAL,GAAUsB,CAAV,GAAcA,CAA5B,CAAN,IAAwC,KAAKD,CAAL,GAASjB,IAAI,CAACe,GAAL,CAASP,GAAT,CAAjD,CAApB,CAFe,CAGf;;MACAD,GAAG,GAAGvB,UAAU,CAACqC,IAAD,CAAhB;IACD,CALD,MAMK,IAAKH,CAAC,GAAG5B,KAAL,GAAcC,OAAlB,EAA2B;MAC9BgB,GAAG,GAAG,KAAKE,KAAX;IACD;EACF;;EACDL,CAAC,CAACC,CAAF,GAAME,GAAN;EACAH,CAAC,CAACE,CAAF,GAAME,GAAN;EACA,OAAOJ,CAAP;AACD;AAED,OAAO,IAAIoB,KAAK,GAAG,CAAC,YAAD,EAAe,MAAf,CAAZ;AACP,eAAe;EACb/B,IAAI,EAAEA,IADO;EAEbU,OAAO,EAAEA,OAFI;EAGbiB,OAAO,EAAEA,OAHI;EAIbI,KAAK,EAAEA;AAJM,CAAf"},"metadata":{},"sourceType":"module"}