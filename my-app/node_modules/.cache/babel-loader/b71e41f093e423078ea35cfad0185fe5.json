{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useLeafletContext } from \"@react-leaflet/core\";\nimport * as L from \"leaflet\";\nimport { useState, useEffect } from \"react\";\nvar points = [];\nL.CustomLayer = L.Layer.extend({\n  // -- initialized is called on prototype\n  initialize: function (options) {\n    this._map = null;\n    this._canvas = null;\n    this._frame = null;\n    this._delegate = null;\n    L.setOptions(this, options);\n  },\n  _onMapMove: function () {\n    this.needRedraw();\n  },\n  getEvents: function () {\n    var events = {\n      resize: this._onLayerDidResize,\n      moveend: this._onLayerDidMove,\n      move: this._onMapMove // add this line\n\n    };\n\n    if (this._map.options.zoomAnimation && L.Browser.any3d) {\n      events.zoomanim = this._animateZoom;\n    }\n\n    return events;\n  },\n  delegate: function (del) {\n    this._delegate = del;\n    return this;\n  },\n  needRedraw: function () {\n    if (!this._frame) {\n      this._frame = L.Util.requestAnimFrame(this.drawLayer, this);\n    }\n\n    return this;\n  },\n  //-------------------------------------------------------------\n  _onLayerDidResize: function (resizeEvent) {\n    this._canvas.width = resizeEvent.newSize.x;\n    this._canvas.height = resizeEvent.newSize.y; // Update the position of the canvas based on the current map view\n\n    var center = this._map.getCenter();\n\n    var zoom = this._map.getZoom();\n\n    var pixelBounds = this._map.getPixelBounds();\n\n    var size = this._map.getSize();\n\n    var pixelOrigin = this._map.getPixelOrigin();\n\n    var offset = pixelOrigin.multiplyBy(-1);\n    L.DomUtil.setTransform(this._canvas, offset, 1 / this._map.getZoom());\n  },\n  //-------------------------------------------------------------\n  _onLayerDidMove: function () {\n    // Update the position of the canvas based on the current map view\n    var center = this._map.getCenter();\n\n    var zoom = this._map.getZoom();\n\n    var pixelBounds = this._map.getPixelBounds();\n\n    var size = this._map.getSize();\n\n    var pixelOrigin = this._map.getPixelOrigin();\n\n    var offset = pixelOrigin.multiplyBy(-1);\n    L.DomUtil.setTransform(this._canvas, offset, 1 / this._map.getZoom());\n\n    var topLeft = this._map.containerPointToLayerPoint([0, 0]);\n\n    L.DomUtil.setPosition(this._canvas, topLeft);\n    this.drawLayer();\n  },\n  //-------------------------------------------------------------\n  getEvents: function () {\n    var events = {\n      resize: this._onLayerDidResize,\n      moveend: this._onLayerDidMove\n    };\n\n    if (this._map.options.zoomAnimation && L.Browser.any3d) {\n      events.zoomanim = this._animateZoom;\n    }\n\n    return events;\n  },\n  //-------------------------------------------------------------\n  onAdd: function (map) {\n    this._map = map;\n    this._canvas = L.DomUtil.create('canvas', 'leaflet-layer');\n    this.tiles = {};\n\n    var size = this._map.getSize();\n\n    this._canvas.width = size.x;\n    this._canvas.height = size.y;\n    var animated = this._map.options.zoomAnimation && L.Browser.any3d;\n    L.DomUtil.addClass(this._canvas, 'leaflet-zoom-' + (animated ? 'animated' : 'hide'));\n    let pane = this.options.pane ? map.getPanes()[this.options.pane] : map._panes.overlayPane;\n    pane.appendChild(this._canvas);\n    map.on(this.getEvents(), this);\n    var del = this._delegate || this;\n    del.onLayerDidMount && del.onLayerDidMount(); // -- callback\n\n    const ctx = this._canvas.getContext(\"2d\");\n\n    const rect = this._canvas.getBoundingClientRect();\n\n    let painting = false;\n\n    function startPosition() {\n      painting = true;\n    }\n\n    ;\n\n    function finishedPosition() {\n      painting = false;\n      ctx.beginPath();\n    }\n\n    ;\n\n    function draw(e) {\n      if (!painting) return;\n      ctx.lineWidth = 1;\n      ctx.lineCap = \"round\";\n      ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);\n      ctx.stroke();\n      ctx.beginPath();\n      ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);\n      map.scrollWheelZoom.disable();\n      map.dragging.disable();\n      map.touchZoom.disable();\n      map.doubleClickZoom.disable();\n      map.boxZoom.disable();\n      map.keyboard.disable();\n      points.push([e.clientX - rect.left, e.clientY - rect.top]);\n    }\n\n    ;\n\n    this._canvas.addEventListener('mousedown', startPosition);\n\n    this._canvas.addEventListener('mouseup', finishedPosition);\n\n    this._canvas.addEventListener('mousemove', draw);\n\n    this._canvas.style.position = \"absolute\";\n    this._canvas.style.cursor = \"crosshair\";\n\n    this._canvas.addEventListener('mouseup', function (e) {\n      // Create a GeoJSON layer and add it to the map\n      const geojson = {\n        \"type\": \"FeatureCollection\",\n        \"features\": [{\n          \"type\": \"Feature\",\n          \"geometry\": {\n            \"type\": \"LineString\",\n            \"coordinates\": points.map(point => {\n              const latlng = map.containerPointToLatLng([point[0], point[1]]);\n              return [latlng.lng, latlng.lat];\n            })\n          }\n        }]\n      };\n      L.geoJSON(geojson).addTo(map); // Clear the points array\n\n      points = [];\n    });\n\n    this.needRedraw();\n  },\n  //-------------------------------------------------------------\n  onRemove: function (map) {\n    var del = this._delegate || this;\n    del.onLayerWillUnmount && del.onLayerWillUnmount(); // -- callback\n\n    let pane = this.options.pane ? map.getPanes()[this.options.pane] : map._panes.overlayPane;\n    pane.removeChild(this._canvas);\n    map.off(this.getEvents(), this);\n    this._canvas = null; // Clear the points array\n\n    points = [];\n    map.scrollWheelZoom.enable();\n    map.dragging.enable();\n    map.touchZoom.enable();\n    map.doubleClickZoom.enable();\n    map.boxZoom.enable();\n    map.keyboard.enable();\n  },\n  //------------------------------------------------------------\n  addTo: function (map) {\n    map.addLayer(this);\n    return this;\n  },\n  // --------------------------------------------------------------------------------\n  LatLonToMercator: function (latlon) {\n    return {\n      x: latlon.lng * 6378137 * Math.PI / 180,\n      y: Math.log(Math.tan((90 + latlon.lat) * Math.PI / 360)) * 6378137\n    };\n  },\n  //------------------------------------------------------------------------------\n  drawLayer: function () {\n    // -- todo make the viewInfo properties  flat objects.\n    var size = this._map.getSize();\n\n    var bounds = this._map.getBounds();\n\n    var zoom = this._map.getZoom();\n\n    var center = this.LatLonToMercator(this._map.getCenter());\n    var corner = this.LatLonToMercator(this._map.containerPointToLatLng(this._map.getSize()));\n    var del = this._delegate || this;\n    del.onDrawLayer && del.onDrawLayer({\n      layer: this,\n      canvas: this._canvas,\n      bounds: bounds,\n      size: size,\n      zoom: zoom,\n      center: center,\n      corner: corner\n    });\n    this._frame = null;\n  },\n  //x------------------------------------------------------------------------------\n  _animateZoom: function (e) {\n    var scale = this._map.getZoomScale(e.zoom);\n\n    var offset = this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(), e.zoom, e.center);\n\n    L.DomUtil.setTransform(this._canvas, offset, scale);\n  }\n});\n\nconst Map_paint = () => {\n  _s();\n\n  const [isDrawing, setIsDrawing] = useState(false);\n  const ctx = useLeafletContext();\n  useEffect(() => {\n    const canvas_container = ctx.overlayContainer || ctx.map;\n    const new_grid_layer = new L.CustomLayer();\n    canvas_container.addLayer(new_grid_layer);\n    console.log(new_grid_layer._canvas.ctx);\n    console.log(\"points are:\", points);\n    return () => {\n      canvas_container.removeLayer(new_grid_layer);\n    };\n  });\n};\n\n_s(Map_paint, \"DX7qMZmz1qqJ5KMtLnld7LKU3ms=\", false, function () {\n  return [useLeafletContext];\n});\n\n_c = Map_paint;\nexport { points };\nexport default Map_paint;\n\nvar _c;\n\n$RefreshReg$(_c, \"Map_paint\");","map":{"version":3,"names":["useLeafletContext","L","useState","useEffect","points","CustomLayer","Layer","extend","initialize","options","_map","_canvas","_frame","_delegate","setOptions","_onMapMove","needRedraw","getEvents","events","resize","_onLayerDidResize","moveend","_onLayerDidMove","move","zoomAnimation","Browser","any3d","zoomanim","_animateZoom","delegate","del","Util","requestAnimFrame","drawLayer","resizeEvent","width","newSize","x","height","y","center","getCenter","zoom","getZoom","pixelBounds","getPixelBounds","size","getSize","pixelOrigin","getPixelOrigin","offset","multiplyBy","DomUtil","setTransform","topLeft","containerPointToLayerPoint","setPosition","onAdd","map","create","tiles","animated","addClass","pane","getPanes","_panes","overlayPane","appendChild","on","onLayerDidMount","ctx","getContext","rect","getBoundingClientRect","painting","startPosition","finishedPosition","beginPath","draw","e","lineWidth","lineCap","lineTo","clientX","left","clientY","top","stroke","moveTo","scrollWheelZoom","disable","dragging","touchZoom","doubleClickZoom","boxZoom","keyboard","push","addEventListener","style","position","cursor","geojson","point","latlng","containerPointToLatLng","lng","lat","geoJSON","addTo","onRemove","onLayerWillUnmount","removeChild","off","enable","addLayer","LatLonToMercator","latlon","Math","PI","log","tan","bounds","getBounds","corner","onDrawLayer","layer","canvas","scale","getZoomScale","_latLngToNewLayerPoint","getNorthWest","Map_paint","isDrawing","setIsDrawing","canvas_container","overlayContainer","new_grid_layer","console","removeLayer"],"sources":["/Users/romanradionov/PycharmProjects/reactleafletgeodjango/my-app/src/DrawingArea.js"],"sourcesContent":["import {useLeafletContext} from \"@react-leaflet/core\";\nimport * as L from \"leaflet\";\nimport {useState, useEffect} from \"react\";\n\n\n\n\n\n\n\n\n\n\nvar points = [];\n\n\nL.CustomLayer = L.Layer.extend({\n\n\n\n    // -- initialized is called on prototype\n    initialize: function (options) {\n        this._map = null;\n        this._canvas = null;\n        this._frame = null;\n        this._delegate = null;\n        L.setOptions(this, options);\n    },\n\n    _onMapMove: function () {\n  this.needRedraw();\n},\n\ngetEvents: function () {\n  var events = {\n    resize: this._onLayerDidResize,\n    moveend: this._onLayerDidMove,\n    move: this._onMapMove, // add this line\n  };\n  if (this._map.options.zoomAnimation && L.Browser.any3d) {\n    events.zoomanim = this._animateZoom;\n  }\n\n  return events;\n},\n\n    delegate: function (del) {\n        this._delegate = del;\n        return this;\n    },\n\n    needRedraw: function () {\n        if (!this._frame) {\n            this._frame = L.Util.requestAnimFrame(this.drawLayer, this);\n        }\n        return this;\n    },\n\n    //-------------------------------------------------------------\n    _onLayerDidResize: function (resizeEvent) {\n    this._canvas.width = resizeEvent.newSize.x;\n    this._canvas.height = resizeEvent.newSize.y;\n\n    // Update the position of the canvas based on the current map view\n    var center = this._map.getCenter();\n    var zoom = this._map.getZoom();\n    var pixelBounds = this._map.getPixelBounds();\n    var size = this._map.getSize();\n    var pixelOrigin = this._map.getPixelOrigin();\n\n    var offset = pixelOrigin.multiplyBy(-1);\n\n    L.DomUtil.setTransform(this._canvas, offset, 1 / this._map.getZoom());\n},\n\n    //-------------------------------------------------------------\n   _onLayerDidMove: function () {\n    // Update the position of the canvas based on the current map view\n    var center = this._map.getCenter();\n    var zoom = this._map.getZoom();\n    var pixelBounds = this._map.getPixelBounds();\n    var size = this._map.getSize();\n    var pixelOrigin = this._map.getPixelOrigin();\n\n    var offset = pixelOrigin.multiplyBy(-1);\n\n    L.DomUtil.setTransform(this._canvas, offset, 1 / this._map.getZoom());\n\n    var topLeft = this._map.containerPointToLayerPoint([0, 0]);\n    L.DomUtil.setPosition(this._canvas, topLeft);\n\n    this.drawLayer();\n},\n\n\n    //-------------------------------------------------------------\n    getEvents: function () {\n        var events = {\n            resize: this._onLayerDidResize,\n            moveend: this._onLayerDidMove\n        };\n        if (this._map.options.zoomAnimation && L.Browser.any3d) {\n            events.zoomanim = this._animateZoom;\n        }\n\n        return events;\n    },\n    //-------------------------------------------------------------\n    onAdd: function (map) {\n        this._map = map;\n        this._canvas = L.DomUtil.create('canvas', 'leaflet-layer');\n        this.tiles = {};\n\n        var size = this._map.getSize();\n        this._canvas.width = size.x;\n        this._canvas.height = size.y;\n\n        var animated = this._map.options.zoomAnimation && L.Browser.any3d;\n        L.DomUtil.addClass(this._canvas, 'leaflet-zoom-' + (animated ? 'animated' : 'hide'));\n\n        let pane = this.options.pane ? map.getPanes()[this.options.pane] : map._panes.overlayPane;\n        pane.appendChild(this._canvas);\n\n        map.on(this.getEvents(), this);\n\n        var del = this._delegate || this;\n        del.onLayerDidMount && del.onLayerDidMount(); // -- callback\n\n        \n\n        const ctx = this._canvas.getContext(\"2d\");\n        const rect = this._canvas.getBoundingClientRect()\n\n\n\n\n\n\n        let painting = false;\n\n        function startPosition() {\n            painting = true\n\n        };\n\n        function finishedPosition () {\n            painting = false;\n            ctx.beginPath();\n        };\n\n\n        function draw (e) {\n            if(!painting) return;\n            ctx.lineWidth = 1;\n            ctx.lineCap = \"round\";\n            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);\n            map.scrollWheelZoom.disable()\n            map.dragging.disable()\n            map.touchZoom.disable()\n            map.doubleClickZoom.disable()\n            map.boxZoom.disable()\n            map.keyboard.disable()\n            points.push([e.clientX - rect.left, e.clientY - rect.top]);\n        };\n\n        this._canvas.addEventListener('mousedown', startPosition);\n        this._canvas.addEventListener('mouseup', finishedPosition);\n        this._canvas.addEventListener('mousemove', draw);\n        this._canvas.style.position = \"absolute\";\n        this._canvas.style.cursor = \"crosshair\"\n        this._canvas.addEventListener('mouseup', function(e) {\n\n            // Create a GeoJSON layer and add it to the map\n        const geojson = {\n            \"type\": \"FeatureCollection\",\n            \"features\": [{\n                \"type\": \"Feature\",\n                \"geometry\": {\n                    \"type\": \"LineString\",\n                    \"coordinates\": points.map(point => {\n                        const latlng = map.containerPointToLatLng([point[0], point[1]]);\n                        return [latlng.lng, latlng.lat];\n                    })\n                }\n            }]\n        };\n        L.geoJSON(geojson).addTo(map);\n\n        // Clear the points array\n        points = [];\n    });\n\n\n\n\n\n\n\n\n\n\n        this.needRedraw();\n\n\n    },\n\n    //-------------------------------------------------------------\n    onRemove: function (map) {\n        var del = this._delegate || this;\n        del.onLayerWillUnmount && del.onLayerWillUnmount(); // -- callback\n\n\n\n        let pane = this.options.pane ? map.getPanes()[this.options.pane] : map._panes.overlayPane;\n        pane.removeChild(this._canvas);\n\n        map.off(this.getEvents(), this);\n\n        this._canvas = null;\n\n\n        // Clear the points array\n        points = [];\n\n        map.scrollWheelZoom.enable();\n        map.dragging.enable();\n        map.touchZoom.enable();\n        map.doubleClickZoom.enable();\n        map.boxZoom.enable();\n        map.keyboard.enable();\n\n\n\n    },\n\n    //------------------------------------------------------------\n    addTo: function (map) {\n        map.addLayer(this);\n        return this;\n    },\n\n    // --------------------------------------------------------------------------------\n    LatLonToMercator: function (latlon) {\n        return {\n            x: latlon.lng * 6378137 * Math.PI / 180,\n            y: Math.log(Math.tan((90 + latlon.lat) * Math.PI / 360)) * 6378137\n        };\n    },\n\n    //------------------------------------------------------------------------------\n    drawLayer: function () {\n        // -- todo make the viewInfo properties  flat objects.\n        var size = this._map.getSize();\n        var bounds = this._map.getBounds();\n        var zoom = this._map.getZoom();\n\n        var center = this.LatLonToMercator(this._map.getCenter());\n        var corner = this.LatLonToMercator(this._map.containerPointToLatLng(this._map.getSize()));\n\n        var del = this._delegate || this;\n        del.onDrawLayer && del.onDrawLayer({\n            layer: this,\n            canvas: this._canvas,\n            bounds: bounds,\n            size: size,\n            zoom: zoom,\n            center: center,\n            corner: corner\n        });\n        this._frame = null;\n    },\n\n\n\n    //x------------------------------------------------------------------------------\n    _animateZoom: function (e) {\n        var scale = this._map.getZoomScale(e.zoom);\n        var offset = this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(), e.zoom, e.center);\n\n        L.DomUtil.setTransform(this._canvas, offset, scale);\n    },\n\n\n\n\n\n});\n\n\n\n\n\n\n\n\nconst Map_paint = () => {\n    const [isDrawing, setIsDrawing] = useState(false)\n\n\n    const ctx = useLeafletContext()\n\n\n\n\n\n\n\n\n\n\n\n\n\n    useEffect(() => {\n\n    const canvas_container = ctx.overlayContainer || ctx.map\n    const new_grid_layer = new L.CustomLayer\n\n    \n\n\n\n\n        canvas_container.addLayer(new_grid_layer)\n\n\n\n        console.log(new_grid_layer._canvas.ctx)\n        console.log(\"points are:\", points)\n\n\n        return () => {\n            canvas_container.removeLayer(new_grid_layer)\n\n\n\n        }\n\n\n        })\n\n\n\n\n\n\n}\n\nexport {points}\nexport default Map_paint"],"mappings":"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"},"metadata":{},"sourceType":"module"}