!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],e):"object"==typeof exports?exports.CanvasLayer=e(require("leaflet")):t.CanvasLayer=e(t.leaflet)}(this,function(t){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),r=function(t){function e(e){var n=t.call(this,e)||this;return n._map=null,n._canvas=null,n._frame=null,n._delegate=null,n}return o(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),e.prototype.getEvents=function(){var t={moveend:this._onLayerDidMove};return this._map.options.zoomAnimation&&a.Browser.any3d&&(t.zoomanim=this._animateZoom),t},e.prototype.onAdd=function(t){this._map=t,this._canvas=a.DomUtil.create("canvas","leaflet-layer");var e=this._map.getSize();this._canvas.width=e.x,this._canvas.height=e.y;var n=this._map.options.zoomAnimation&&a.Browser.any3d;a.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(n?"animated":"hide")),t.getPanes().overlayPane.appendChild(this._canvas);var o=this._delegate||this;return o.onLayerDidMount&&o.onLayerDidMount(),this.needRedraw(),this},e.prototype.onRemove=function(t){var e=this._delegate||this;return e.onLayerWillUnmount&&e.onLayerWillUnmount(),t.getPanes().overlayPane.removeChild(this._canvas),this._canvas=null,this},e.prototype.needRedraw=function(){return this._frame||(this._frame=a.Util.requestAnimFrame(this.drawLayer,this)),this},e.prototype.delegate=function(t){return this._delegate=t,this},e.prototype._onLayerDidResize=function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},e.prototype._onLayerDidMove=function(){var t=this._map.containerPointToLayerPoint([0,0]);a.DomUtil.setPosition(this._canvas,t),this.drawLayer()},e.prototype.LatLonToMercator=function(t){return{x:6378137*t.lng*Math.PI/180,y:6378137*Math.log(Math.tan((90+t.lat)*Math.PI/360))}},e.prototype.drawLayer=function(){var t=this._map.getSize();this._canvas.width=t.x,this._canvas.height=t.y;var e=this._map.getBounds(),n=this._map.getZoom(),o=this.LatLonToMercator(this._map.getCenter()),a=this.LatLonToMercator(this._map.containerPointToLatLng(this._map.getSize())),r=this._delegate||this;r.onDrawLayer&&r.onDrawLayer({bounds:e,canvas:this._canvas,center:o,corner:a,layer:this,size:t,zoom:n}),this._frame=null},e.prototype._animateZoom=function(t){var e=t.target.getZoomScale(t.zoom,t.target.getZoom()),n=this._map._latLngBoundsToNewLayerBounds(this._map.getBounds(),t.zoom,t.center).min;a.DomUtil.setTransform(this._canvas,n,e)},e}(a.Layer);e.CanvasLayer=r},function(e,n){e.exports=t}])});